<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>R basics and the tidyverse</title>
    <meta charset="utf-8" />
    <meta name="author" content="Pablo Raguet   email: pablo.raguet@inrae.fr       original teacher: Tania L. Maxwell   website: tania-maxwell.github.io" />
    <script src="R_intro_tidyverse_files/header-attrs-2.17/header-attrs.js"></script>
    <link href="R_intro_tidyverse_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="R_intro_tidyverse_files/remark-css-0.0.1/rladies.css" rel="stylesheet" />
    <link href="R_intro_tidyverse_files/remark-css-0.0.1/rladies-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# R basics and the tidyverse
]
.subtitle[
## Session 1 LOVEâ€™R course
]
.author[
### Pablo Raguet <br> email: <a href="mailto:pablo.raguet@inrae.fr" class="email">pablo.raguet@inrae.fr</a> <br> <br> <br> original teacher: Tania L. Maxwell <br> website: tania-maxwell.github.io
]
.date[
### 07-11-2022
]

---





layout: true
background-image: url(images/logos_new.png)
background-position: 50% 100%
background-size: 30%

---

## Who am I?
- Final year PhD student at INRAE, finishing a double degree program between the UniversitÃ© de Bordeaux and UniversitÃ© Laval in QuÃ©bec

- Studying the dynamic and modelling of organic phosphorus in cropped soil under various field conditions.

- R enthusiast, coder


&lt;img src="images/week1/CycleP_simple3_EN-page002.png" width="40%" style="display: block; margin: auto;" /&gt;


---

## 

&lt;img src="images/week1/r_first_then.png" width="60%" style="display: block; margin: auto;" /&gt;
&lt;center&gt; @allison_horst &lt;/center&gt;

---
## R Course Objectives

- Understand the basis of the R language to be able to write your own scripts

--

- Optimize your dataset table (7/11)

--

- Choose a statistical model according to your scientific question (10/11 &amp; 14/11)

--

- Create reproducible graphics (17/11)

--

- Know how to search for resources related to your question or code problem in R

---

## How this course works

- This is an interactive course, which means you will be coding throughout the course

- When you see this symbol, you use code to answer a question that I've stated:

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;

- Don't hesitate to ask questions  

- There will be a final project to be done in groups of 2, with a presentation on November 24th (more details will be given at the end of this course). 

---

layout: false

class: center, middle

## R basics

---

layout: true
background-image: url(images/logos_new.png)
background-position: 50% 100%
background-size: 30%

---

## The multiple facets of R 

R is a programming language, and RStudio is a graphical interface to help users with R  

R is open source, which means there are plenty of great solutions to issues that can be found online 

--

&lt;img src="images/week1/the_why_r_plot.png" width="80%" style="display: block; margin: auto;" /&gt;
&lt;center&gt; @CSBQ &lt;/center&gt;


---
## Let's get started

Open Rstudio, click on:  

&lt;center&gt; File â†’ New File â†’ R Script &lt;/center&gt;

Save the R Script with an easy-to-find name

&lt;br&gt; 

--

## Good Practices

- Comment your code by using the # symbol 
- Write in your script, and then click **run** to evaluate the code in the console 

**Tip:** You can also press "Ctrl" and "Enter" to run your code

---

## Explore R Studio

&lt;img src="images/week1/Rstudio.png" width="100%" style="display: block; margin: auto;" /&gt;

**Tip:** you can change the colors of RStudio in 

&lt;center&gt; Tools â†’ Global Options â†’ Appearance &lt;/center&gt;

---

## Working directory

### In RStudio
We use the `setwd()` function so that R knows where to look for the data table. We can use `getwd()` to see in which directory we currently are.


```r
getwd()
```

```
## [1] "/home/pablo/Documents/THESE/Teachings/R-course-2022"
```

--


**Tip:** manually set your directory by clicking

&lt;center&gt; Session â†’ Set Working Directory â†’ Choose Directory &lt;/center&gt;

Copy-paste the output from the R console into your script so that you only need to do it once. 


```r
# setwd("/directory/of/your/R-script/from/root")
```

---
## R code with R project

- .Rproj file
- All your project inside a folder
- Relative path
- code reproductivity
- Git use

---

## Renv the package manager

- local save of packages and their version
- limit code break due to package update

---

## Tips for Rproj

### Structure your path
- Folders "data", "Export"
- names your scripts starting by a number (01)
- tell to another coder which script should be run first

### Structure your code
- Head
- Working directory check
- loading packages (next slide)
- data import (further slide)
- Divide your code in parts and eventually in different scripts
  - Data manipulation
  - Statistics
  - Graphics
  - Exportation

Tips: create a separate .R script for function
 call by `source("name_of_fun_file.R")`
---
## Loading the necessary package(s)

If you have not yet installed the metapackage `tidyverse`, you can do by clicking in the bottom right pannel: 

&lt;center&gt; Packages â†’ Install, and typing the package name &lt;/center&gt;

Or, you can run it in your script without the #

```r
# install.packages("tidyverse")
```

--

You need to tell R where to look in its library for the packages you will use in your script.


```r
library(tidyverse)
```

```
## â”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.2 â”€â”€
## âœ” ggplot2 3.3.6      âœ” purrr   0.3.5 
## âœ” tibble  3.1.8      âœ” dplyr   1.0.10
## âœ” tidyr   1.2.1      âœ” stringr 1.4.1 
## âœ” readr   2.1.3      âœ” forcats 0.5.2 
## â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
## âœ– dplyr::filter() masks stats::filter()
## âœ– dplyr::lag()    masks stats::lag()
```

**Tip:** At the beginning of each script, only include the libraries which you will actually use. 

---

## R as a calculator

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
Type the following in your script and execute your code:

&lt;center&gt; 5*9-2+4 &lt;/center&gt;

--


```r
5*9-2+4
```

```
## [1] 47
```

--
What does the [1] mean ?

Hint: type `1:50` into your script

--


```r
1:50
```

```
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
```

The [1] is a way to **index** the output = to locate the place in the string of numbers
---

## Objects in R 

- You can save values as objects 


```r
var1 &lt;- 5*9
var2 &lt;- 2+3
```

- Objects are stored in your Global Environment "Values"

--

&lt;br&gt;
&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
Create a new variable which is the multiplication of var1 and var2

--


```r
var3 &lt;- var1*var2
```

- What is the value of var3?

--


```r
var3
```

```
## [1] 225
```

---
## Arithmetic operators in R

| Character |  | Character |  | 
|---| ---  | --- | ---  |
| + | addition | / | division |
| - | substraction | %/%  | integer division |
| ^ | exponent | %%   | modulus | 
| * | multiplication |  |  |  | 

--
Examples of different operators:


```r
10/3 ; 10%/%3 ; 10%%3
```

```
## [1] 3.333333
```

```
## [1] 3
```

```
## [1] 1
```

---

## Tips for naming objects

- The first character should be a letter, i.e. var1 and not 1var


--

- The names should only include the following: letters, numbers, _ and . 

--

- Avoid using accents in your code, as it will may have troubles encripting (which is why I recommend to code in English)

--

- Don't use special keywords as names of your object (i.e. break, function, if,  etc. ). They will highlight when you type it in R

--

- Choose names which add meaning to your code (because it is likely that in 3 months you will have to decipher your code) 

--

- Use relatively short names (recommended)

---

## Functions 

A function is an argument with an input and an output

The arguments (what goes into the parentheses `()`) are objects (i.e. var1, var2, data frames, etc.)
--

Example: the `sum()` function

```r
var4 &lt;- sum(var1,var2,var3)
var4
```

```
## [1] 275
```

Functions have arguments that need a certain order (to be detailled later)

--

Some useful arithmetic function:

| Function | *single results*  | Function | *applied to each element of a vector* | 
|---| ---  | --- | ---  |
| sum() | addition | exp() | exponential |
| mean() | average | log()  | logarythm |
| prod() | multiplication | sqrt()   | square root | 
| sd() | standard deviation | ? |  standard error  | 

---
## Build your own function (1)

Create an object with the `function()` function. Example for coefficient of variation:


```r
var5 &lt;- c(2, 6, 1, 8)
```
  

```r
Fun.cv &lt;- function(x) { 
  cv &lt;- sd(x) / mean(x)
  return(cv)
}
Fun.cv(var5)
```

```
## [1] 0.7774207
```

--

Usefull functions to build your own function:

| Function | Effect  | Function | Effect  |
| --- | ---  | ---  | ---  |
| print(x) | print the object `x` | stop(m) | stop the function and print the message `m` | 
| return(x) | return the object `x` at the end of the function | warning(m) | print a warning with the message `m`  |

---
## Build your own function (2)
&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
The standard error function does not exist in R, how would you build that function ?

Use:

```r
var5 &lt;- c(2, 6, 1, 8) ; var5
```

```
## [1] 2 6 1 8
```

--

**Tips:**

`\(se = \frac{\sigma}{\sqrt{n}}\)`

With `\(\sigma\)` the vector standard deviation and `n` the `length()` of the vector.

---
## Build your own function: solution(s)

--

- Simple solution


```r
Fun.se.1 &lt;- function(x){sd(x)/sqrt(length(x))}
```


```r
Fun.se.1(var5)
```

```
## [1] 1.652019
```

--

- Complex solution

```r
Fun.se.2 &lt;- function(x){
  a &lt;- (sd(x)/sqrt(length(x)))
  return(a)
}
```


```r
Fun.se.2(var5)
```

```
## [1] 1.652019
```

---

## Data structures in R

&lt;img src="images/week1/data_structure.png" width="80%" style="display: block; margin: auto;" /&gt;

---

## Let's create a data frame from scratch

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
**Step 1:** Create vectors 


```r
#Character vectors
plant_sp &lt;- c("tomato", "tomato", "tomato", "tomato")

treatment &lt;- c("stress", "stress", "control", "control")
```

--


```r
#Numerical vector
diameter &lt;- c(2.3, 3.4, 4.3, 4.8)
```

--

**Step 2:** Combine the vectors with the `data.frame()` function


```r
plant_data &lt;- data.frame(plant_sp, treatment, diameter) ; plant_data
```

```
##   plant_sp treatment diameter
## 1   tomato    stress      2.3
## 2   tomato    stress      3.4
## 3   tomato   control      4.3
## 4   tomato   control      4.8
```

---

## Indexing 

data_frame_name[`row`, `column`]

matrix[`row`, `column`]

vector[`element`]

list[[`element`]]

--

**Example:** 

`plant_data[1, ]` â†’ Extracts the first row

*Note: empty index selects all the values*

`plant_data[ ,3]` â†’ Extracts the third column

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;

Extract the second value from the third column

---

## Solution


```r
plant_data[2,3]
```

```
## [1] 3.4
```


---

## Indexing 

You can use this to easily remove columns or rows from your data frame. 

Examples: 


```r
#remove column 1
plant_data_reduced1 &lt;- plant_data[ , -1]
plant_data_reduced1
```

```
##   treatment diameter
## 1    stress      2.3
## 2    stress      3.4
## 3   control      4.3
## 4   control      4.8
```

--


```r
#keep only row 3 and 4
plant_data_reduced2 &lt;- plant_data[c(3,4), ]
plant_data_reduced2
```

```
##   plant_sp treatment diameter
## 3   tomato   control      4.3
## 4   tomato   control      4.8
```

---

## Your turn

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;


Create a new data frame with just rows 1 and 2, and columns 2 and 3 of the `plant_data` data frame 

---

## Solution (different ways to do this)


```r
#option 1
reduced_option1&lt;- plant_data[c(1,2), c(2,3)]
reduced_option1
```

```
##   treatment diameter
## 1    stress      2.3
## 2    stress      3.4
```

```r
#option 2
reduced_option2&lt;- plant_data[c(1,2), -1]
reduced_option2
```

```
##   treatment diameter
## 1    stress      2.3
## 2    stress      3.4
```

```r
#etc...
```


---

## Where to find help 

R help and documentation:

- press `F1` with the cursor on the function

- execute `?function`

--

Online! 

- Stackoverflow

- Cross-validated 

- Google

**"R how to ..."** is my most frequent google search - and you almost always find an answer to your question. 

---

layout: false

class: center, middle

## Tidy data: using the `tidyverse` metapackage


```
## 
## Attachement du package : 'gridExtra'
```

```
## L'objet suivant est masquÃ© depuis 'package:dplyr':
## 
##     combine
```

&lt;img src="R_intro_tidyverse_files/figure-html/unnamed-chunk-17-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---

layout: true
background-image: url(images/logos_new.png)
background-position: 50% 100%
background-size: 30%

---

## How do we set up a data table? 

Example: You are setting up an experiment with four plants of corn, and you are measuring the height (cm) at five different time points (T1, T2, T3, T4, T5) .   

&lt;br&gt;
**On a piece of paper, write down a draft of your data table**
---

## "Intuitive" data table 

| Plant | Height_T1_cm | Height_T2_cm | Height_T3_cm | Height_T4_cm | Height_T5_cm | 
|---|---|---|---|---|---|
|CornA| 10 | 12 | 15| 25| 30|
|CornB | 9.5 | 11| ...| ...|... |
|CornC |  | | | | | 
|CornD |  | | | | | 


---

## More effective data table for R 

| Plant | Time | Height_cm | 
|---|---|---|
|CornA| T1 | 10|
|CornA| T2 | 12|
|CornA| T3 | 15|
|CornA| T4 | 25|
|CornA| T5 | 30|
|CornB| T1 | 9.5|
|CornB| T2 | 11
|...| ... | ...|


This is what we call 'tidy data' or 'long format'.
---
## Introduction to 'tidy data'


&lt;img src="images/week1/tidydata_1.jpg" width="110%" style="display: block; margin: auto;" /&gt;
&lt;center&gt; @allison_horst &lt;/center&gt;

---

## Why use 'tidy data'? 

- Most efficient way for R to read your data

- Easier for automation and iteration 

- Moving from Excel to R for all calculations : reproducible 

&lt;img src="images/week1/tidydata_2.jpg" width="80%" style="display: block; margin: auto;" /&gt;
&lt;center&gt; @allison_horst &lt;/center&gt;


---

## Importing a data file

If data is under Excel file format, save as a .csv or a .txt file. 

We use the `read.table()` function. The "sep" (separator) will likely be different whether you are importing a .csv or a .txt file.


```r
data_co2 &lt;- read.table("Exemple/CO2_data_fromR.txt", header = TRUE, sep = "\t")
```

- The dataset shows results of an experiment on the cold tolerance of grass. 
- Grass samples from two regions (Quebec and Mississippi) were grown in either a chilled or nonchilled environment
- Their CO&lt;sub&gt;2&lt;/sub&gt; uptake rate was tested at different CO&lt;sub&gt;2&lt;/sub&gt; concentrations.

---

## Exploring the data

Use the `str()` function to look at the structure of your data table. 

What do you see? 


```r
str(data_co2)
```

```
## 'data.frame':	84 obs. of  5 variables:
##  $ Plant    : chr  "Qn1" "Qn1" "Qn1" "Qn1" ...
##  $ Type     : chr  "Quebec" "Quebec" "Quebec" "Quebec" ...
##  $ Treatment: chr  "nonchilled" "nonchilled" "nonchilled" "nonchilled" ...
##  $ conc     : int  95 175 250 350 500 675 1000 95 175 250 ...
##  $ uptake   : num  16 30.4 34.8 37.2 35.3 39.2 39.7 13.6 27.3 37.1 ...
```

--

There are four main data type: 
- `int` = integer (whole numbers) 
- `num` = numeric
- `chr` = character, alphabetical characters
- `Factor` = for both alphabetical and numerical characters, **can be placed in a certain order** 

---

## Selecting a column 

The `$` symbol selects a column. But there are other ways to do this: 

`data_co2$ID` ,

`data_co2[ , "ID" ]`,  

`data_co2[ , 1]` (because ID is the first column) 

are **all the same** 

---

## Changing data types for a column

Let's say we want to make the ID number a **factor**, we can use the `as.factor()` function  
- Note: this often happens when numbers are used to identify different levels in a column, but don't represent the number value

--


```r
#testing the as.factor() function
# data_co2$ID &lt;- as.factor(data_co2$ID)
```
&lt;br&gt; 
Note: Similarly, you can make a factor as a numeric value with `as.numeric()`. 
---

## More useful functions

- the `table()` and `levels()` are useful for numeric and factor columns, respectively  


```r
table(data_co2$conc)
```

```
## 
##   95  175  250  350  500  675 1000 
##   12   12   12   12   12   12   12
```

```r
levels(data_co2$Treatment)
```

```
## NULL
```

- The `table(data_co2$conc)` gives us the number of observations for each value of `conc` = concentration. 

- The `levels(data_co2$Treatment)` gives us all the levels in the `Treatment` column. 
---

## Data wrangling with `dplyr`

Let's say that you want to find the mean per group in your experiment. 

How would you do this previously? 

--

Because this data table is 'tidy', we can use `dplyr` for such data manipulations and calculations. 

**Important Concept** : "piping" with %&gt;%

    New Data Table &lt;- Data Table %&gt;% 
                      function1  %&gt;% 
                      function 2 
                      etc... 

This reads: "Make a new data table, where you take my data table, apply function 1 to it, and then apply function 2 to the new subset made by function 1 "

---
## Example: means per group 


```r
data_co2_means&lt;- data_co2 %&gt;%
  group_by(Treatment) %&gt;%
  summarise(mean = mean(uptake))

data_co2_means  
```

```
## # A tibble: 2 Ã— 2
##   Treatment   mean
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 chilled     23.8
## 2 nonchilled  30.6
```
-  `group_by()` is the first function

- `summarise()` is the second function, applied to each Treatment. 

- `mean =` names the column in which the `mean(uptake)` is written  
--

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
Make a new data table in which you calculate the mean of the CO2 uptake per plant Type (Quebec vs. Mississippi)  


---

## Solution


```r
data_co2_means_type&lt;- data_co2 %&gt;%
  group_by(Type) %&gt;%
  summarise(mean = mean(uptake))

data_co2_means_type
```

```
## # A tibble: 2 Ã— 2
##   Type         mean
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 Mississippi  20.9
## 2 Quebec       33.5
```

---

#Challenge: means, se, n per group

&lt;img src="images/week1/exercise_smaller.png" width="25%" style="display: block; margin: auto auto auto 0;" /&gt;
Make a new data table in which you calculate the number of variables per observation (n), mean, and standard error of uptake per plant Type (Quebec vs. Mississippi)  

Hint: use the `summarise_each()` and the `funs()` function: 

&lt;center&gt; summarise_each(funs(n = n(), mean = mean(.), se = sd(.)/sqrt(n())), "uptake") &lt;/center&gt;

--


```r
data_co2_means_se&lt;- data_co2 %&gt;%
  group_by(Type) %&gt;%
  summarise_each(funs(n = n(), mean = mean(.), se = sd(.)/sqrt(n())), "uptake")
```

```
## Warning: `summarise_each_()` was deprecated in dplyr 0.7.0.
## â„¹ Please use `across()` instead.
## â„¹ The deprecated feature was likely used in the dplyr package.
##   Please report the issue at &lt;]8;;https://github.com/tidyverse/dplyr/issueshttps://github.com/tidyverse/dplyr/issues]8;;&gt;.
```

```
## Warning: `funs()` was deprecated in dplyr 0.8.0.
## â„¹ Please use a list of either functions or lambdas:
## 
## # Simple named list: list(mean = mean, median = median)
## 
## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
## 
## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
```

```r
data_co2_means_se  
```

```
## # A tibble: 2 Ã— 4
##   Type            n  mean    se
##   &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Mississippi    42  20.9  1.21
## 2 Quebec         42  33.5  1.49
```

---

## Terminology

`dplyr::` means we are using a function from the dplyr package without loading all the package.

x %&gt;% f(y)is the same as f(x, y), 

     data_co2 %&gt;% 
      group_by(Type)
    
    is equal to 
    
    dplyr::group_by(data_co2, Type)  
    


---

## Filtering a data table

&lt;img src="images/week1/dplyr_filter.jpg" width="100%" style="display: block; margin: auto;" /&gt;
&lt;center&gt;@allison_horst&lt;/center&gt;


---

## Your turn

&lt;img src="images/week1/exercise_smaller.png" width="30%" style="display: block; margin: auto auto auto 0;" /&gt;

Using the previous tutorial, filter the data table for the nonchilled treatment in Quebec? 

Hint: 

      new_df &lt;- dplyr:: filter(df, ...)  is the same as 
      new_df&lt;- df %&gt;%
        filter(...)
      
---

## Solution


```r
quebec_nonchilled&lt;- data_co2 %&gt;%
  filter(Type == "Quebec" &amp; Treatment == "nonchilled")
head(quebec_nonchilled )
```

```
##   Plant   Type  Treatment conc uptake
## 1   Qn1 Quebec nonchilled   95   16.0
## 2   Qn1 Quebec nonchilled  175   30.4
## 3   Qn1 Quebec nonchilled  250   34.8
## 4   Qn1 Quebec nonchilled  350   37.2
## 5   Qn1 Quebec nonchilled  500   35.3
## 6   Qn1 Quebec nonchilled  675   39.2
```

And what if we want to directly find the n, mean, and standard error?

--


```r
quebec_nonchilled_mean&lt;- data_co2 %&gt;%
  filter(Type == "Quebec" &amp; Treatment == "nonchilled") %&gt;%
  summarise_each(funs( n = n(), mean = mean(.), se = sd(.)/sqrt(n())), "uptake")
quebec_nonchilled_mean
```

```
##    n     mean     se
## 1 21 35.33333 2.0941
```

---

## Logics in R 

|Character|| Character||
|---|---|---|---|
| &lt; | Less than | &gt; | Greater than |
| != | Not equal to | == | Equal to |
| is.na |Is NA | !is.na |Is not NA |
| &lt;= |Less than or equal to | &gt;= |Greater than or equal to
|%in% |Group membership | 
| &amp;| and| I | or

This can be used within the functions (i.e. when using `filter()`)

---

## More examples


&lt;img src="images/week1/exercise_smaller.png" width="30%" style="display: block; margin: auto auto auto 0;" /&gt;
Pick one or both questions, and use the appropriate function to answer them: 

1. What is the mean `uptake` for each treatment type, for concentration values greater than or equal to 350?

2. Add a new column to the data frame, which multiplies the `conc` by the `uptake`
Hint: use the `mutate()` function 

&lt;br&gt;

Google "Rstudio dplyr cheatsheet" to get the following pdf, which may help
https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf 

---

## Answers


```r
#question 1: mean uptake for each treatment type, 
#for concentration values greater than or equal to 350?
treat_above350 &lt;- data_co2 %&gt;%
  filter(conc &gt;= 350) %&gt;%
  group_by(Treatment) %&gt;%
  summarise(mean = mean(uptake))
treat_above350
```

```
## # A tibble: 2 Ã— 2
##   Treatment   mean
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 chilled     27.6
## 2 nonchilled  35.9
```

```r
#question 2: add a new column to the data frame
#which multiplies the `conc` by the `uptake`
data_co2 &lt;- data_co2 %&gt;%
  mutate(mult = conc*uptake)
head(data_co2)
```

```
##   Plant   Type  Treatment conc uptake  mult
## 1   Qn1 Quebec nonchilled   95   16.0  1520
## 2   Qn1 Quebec nonchilled  175   30.4  5320
## 3   Qn1 Quebec nonchilled  250   34.8  8700
## 4   Qn1 Quebec nonchilled  350   37.2 13020
## 5   Qn1 Quebec nonchilled  500   35.3 17650
## 6   Qn1 Quebec nonchilled  675   39.2 26460
```

---

## So how does R compare to Excel? 

&lt;img src="images/week1/excel_dinosaur.png" width="60%" style="display: block; margin: auto;" /&gt;
&lt;center&gt; @dinosaur &lt;/center&gt;

Manipulating data in R is reproducible and tracable, which means it is less prone to user errors.  

---

## Other useful information

- R for data science:
https://r4ds.had.co.nz/ 
(the other of this book made the tidyverse!)

- Making nice-looking tables from your data:
https://rfortherestofus.com/2019/11/how-to-make-beautiful-tables-in-r/ 

- R references: 
https://cran.r-project.org/doc/contrib/Baggott-refcard-v2.pdf 

- Solutions to common tasks and problems in analyzing data in R: http://www.cookbook-r.com/ 

- Other useful websites for using dplyr:
https://rpubs.com/bradleyboehmke/data_wrangling 
https://seananderson.ca/2014/09/13/dplyr-intro/ 

---
## Group project

-	In pairs (groups of 2), select 2 papers which use linear regressions, ANOVAs and/or mixed models in their statistical analyses (we will go through these in class)

- Send the papers to me by Friday, Nov. 12th (pablo.raguet@inrae.fr), I will choose 1 of those papers for you to prepare a critique 

-	On Monday, Nov. 29th, give a 12min presentation and answer 5-10min of questions (T. Maxwell)

---

## What to present 

- Summarize the research aims and objectives of the paper: are they clear? Does the introduction give a good overview of the subject? 

- Critique the methods and statistical analyses: are they sufficiently detailed? Are they appropriate for the research question? 

- Explain the nature of the data (fixed vs. random factors, replications, etc.)

- Are the statistical tests appropriate? Why or why not? 

- Are the results valid? 

-	How could you improve the paper? 


---
---

layout: false

class: center, middle

## Next week: choosing your statistical test
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
